title: "数列笔记"
date: 2015-03-18 09:26:37
tags: [Mathematic]
---
#Catalan数
##前几项
1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190, 6564120420, 24466267020, 91482563640, 343059613650, 1289904147324, 4861946401452
##计算
h(0)=1,h(1)=1。
###递推式：
$h(n)= h(0)\\times h(n-1)+h(1)*h(n-2) + ... + h(n-1)h(0) (n>=2)$或
$h(n)=h(n-1)\\times\\frac{(4n-2)}{(n+1)}$
###组合数形式
$h(n)=\\frac{\\binom{2n}{n}}{n+1} (n=0,1,2,...)  \\\\\\ h(n)=\\binom{2n}{n}-\\binom{2n}{n+1}(n=0,1,2,...)$
##基础应用
###括号序列计数
长度为2n的合法括号序列数为$h(n)$
###凸多边形三角剖分数
n个顶点的凸多边形三角剖分数为$h(n-2)$
###出栈序列计数
n个元素的出栈序列共有$h(n)$种
###二叉树计数
给定n个点，能构成的不同的二叉树有$h(n)$个
###矩阵路径计数
一个$n\\times n$的方格图，只能向右或向上走，不能穿过对角线（可以在对角线上），从左下到右上的方案数为$h(n)$
##扩展问题
- **$n$个左括号$m$个右括号（$n>m$），合法(任意时刻必须保证左括号剩余的个数大于$0$)的括号序列个数。（从$(0,0)$走到$(n,m)$不穿过对角线$x=y$)**
分两种情况：
①走$(1,0)$，一定不合法。方案数$\binom{n+m-1}{m-1}$。
②走$(0,1)$，有两种情况：A.合法。B.不合法。其中不合法的方案，将它穿过对角线之前的路线关于对角线翻折，一定能和某一个①中的方案重合，所以方案数为$\\binom{n+m-1}{m-1}$。
总方案数为$\binom{n+m}{m}-2\binom{n+m-1}{m-1}$。
- **$n$个左括号$m$个右括号（$n>m$），合法的括号序列个数。（从$(0,0)$走到$(n,m)$不穿过对角线$x=y$（可以经过对角线）**
将上面那个问题中的$n$加上一就可以了。
总方案数$ \\binom{n+m+1}{m}-2\\binom{n+m}{m-1}$
#Stirling数
##第一类Stirling数
记做$\left [ ^{n}\_{k}\right ]$,表示将n个元素排成k个非空轮换的方案数。
###递推式
$\left [ ^{n}\_{k}\right ]=(n-1)\left [ ^{n-1}\_{k}\right ]+\left [^{n-1}\_{k-1}\right ],n>0$
##第二类Stirling数
记做$\left \\{^{n}_{k} \right \\} $,表示n个元素划分为k个非空子集的方案数。
###递推式
$\left \\{ ^{n}\_{k}\right \\}=k\left \\{ ^{n-1}\_{k}\right \\}+\left \\{ ^{n-1}\_{k-1}\right \\}$
##特殊值
$\left [^{n}\_{0} \right]=\left \\{^{n}\_{0}\right\\}=[n=0]\\\ \left\\{^{n}\_{1}\right\\}=[n>0],[^{n}\_{1}]=(n-1)![n>0]\\\\\left\\{^{n}\_{2}\right\\}=(2^{n-1}-1)[n>0],[^{n}\_{2}]=(n-1)!H\_{n-1}[n>0]\\\\\left\\{^{n}\_{n-1}\right\\}=[^{n}\_{n-1}]=\binom{n}{n-1}$
#Bell数
记做$B\_{n}$,表示n个元素的集合的集合划分方案数
##前几项（从0开始）：
>[OEISA000110](http://oeis.org/A000110):1, 1, 2, 5, 15, 52, 203, 877, 4140, 21147, 115975, 678570, 4213597, 27644437, 190899322, 1382958545, 10480142147, 82864869804, 682076806159, 5832742205057, 51724158235372, 474869816156751, 4506715738447323, 44152005855084346, 445958869294805289, 4638590332229999353, 49631246523618756274 

##递推式
$B\_{n}=\sum\_{k=0}^{n-1}\binom{n-1}{k}B\_{k}\\\B\_{n}=\sum\_{i=1}^{n}\\{^{n}\_{i}\\}$
##Bell三角形
第一行第一项是1。
对于n>1，第n行第1项等于n−1行的最后一项。
对于m,n>1，第n行第m项等于它左边和左上方的两个数的和。
每行首项是贝尔数，每行的和为第二类Stirling数。
##同余关系
1.$B\_{p+n}\equiv B\_{n}+B{n+1}(mod\ p)\\\ B\_{p^{m}+n}\equiv mB\_{n}+B{n+1}(mod\ p)\\\p是<100的素数$
2.Bell数模素数p的周期为：$\\frac{p^{p}-1}{p-1}$
##预处理Bell数
```
void Bell(int T[],int MOD)
{
    B[0] = 1;
    B[1] = 1;
    T[0] = 1;
    for(int i=2;i<N;i++)
    {
        T[i-1] = B[i-1];
        for(int j=i-2;j>=0;j--)
            T[j] = (T[j]+T[j+1])%MOD;
        B[i] = T[0];
    }
}
```
#Bernoulli数
$\sum\_{i=0}^{n-1}i^{m}=\frac{1}{m+1}\sum\_{k=0}^{m}\binom{m+1}{k}B\_{k}n^{m+1-k}\\\\\sum\_{j=0}^{m}\binom{m+1}{j}B\_{j}=[m=0],m \leq 0$
